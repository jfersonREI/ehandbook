define("layoutko",function(){return{loadTopBanner:function(e){new Platform.LegacyLayoutModern(e).loadTopBanner()}}});var Platform;!function(e){var t=function(){function e(t){this.topBannerVisible=!0,this.userTypeCode=1,this.activeTab="",this.cookie="",this.homePageUrl="",t.layoutServiceBaseUrl&&(this.layoutServiceBaseUrl=t.layoutServiceBaseUrl),t.pfmCoreUiBaseUrl&&(this.pfmCoreUiBaseUrl=t.pfmCoreUiBaseUrl),t.epsBaseUrl&&(e.epsBaseUrl=t.epsBaseUrl),t.visible&&(this.topBannerVisible=t.visible),t.userTypeCode&&(this.userTypeCode=t.userTypeCode),t.activeTab&&(this.activeTab=t.activeTab.toLowerCase()),t.cookie&&(this.cookie=t.cookie),t.homePageUrl&&(this.homePageUrl=t.homePageUrl),t.shortName&&(this.shortName=t.shortName),t.fullName&&(this.fullName=t.fullName),t.logoutUrl&&(this.logoutUrl=t.logoutUrl),t.userName&&(this.userName=t.userName)}return e.prototype.getAuthToken=function(){var t=this,o=$.Deferred(),s=window.sessionStorage.getItem("eps_access_token");return""===(s||"")?$.ajax({method:"POST",url:e.epsBaseUrl+"account/token",xhrFields:{withCredentials:!0},beforeSend:function(e){},contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:"application/json",data:{pfmCookie:t.cookie}}).done(function(e,s,i){window.sessionStorage.setItem("eps_access_token",e.access_token||""),setTimeout(function(){t.getAuthToken()},1e3*(e.expires_in-10)),o.resolve(e.access_token)}).fail(function(e){o.resolve("")}):o.resolve(s),o},e.prototype.getGsrBaseUrl=function(){var e=this,t=$.Deferred();if(""!==(this.gsrBaseUrl||""))return t.resolve(this.gsrBaseUrl),t;var o={externalSystemCode:248,externalSystemDimensionCode:4};return $.ajax({method:"GET",url:this.pfmCoreUiBaseUrl.replace("Platform.Core.UI","PlatformServices").replace("localhost:63607","localhost:53591")+"api/url/GetExternalSystemDimension",data:o,cache:!1,xhrFields:{withCredentials:!0}}).done(function(o){e.gsrBaseUrl=o,t.resolve(o)}).fail(function(e){t.resolve("")}),t},e.prototype.loadTopBanner=function(){function e(){var e=this;e.isLoggedIn=ko.observable(!0),e.visible=t.topBannerVisible,e.layoutServiceBaseUrl=t.layoutServiceBaseUrl,e.selectedTab=ko.observable(""),e.isFlyoutOpen=ko.observable(!1),e.activeTab=t.activeTab,e.isTooltipOpen=ko.observable(!1),e.openTab=ko.observable(null),e.gsrUrlXhr=t.getGsrBaseUrl(),e.isSearchDropdownVisible=ko.observable(!1),e.toggleSearchDropdown=function(){e.isSearchDropdownVisible(!e.isSearchDropdownVisible())},e.toggleUserMenu=function(e,t){t.currentTarget.classList.toggle("user-active")};var i={suggestionsOpen:ko.observable(!1),showNoResultFlyout:ko.observable(!1),categoriesOpen:ko.observable(!1),defaultSearch:ko.observable(!0),categoryName:ko.observable(""),showSuggestions:ko.observable(!0),activeIndex:ko.observable(0)};i.category=ko.observable(null),i.results=ko.observable([new o(0,"")]),i.inputText=ko.observable(""),i.inputText.subscribe(function(e){i.showSuggestions()&&i.search()}),i.toggleCategoryMenu=function(e){return!0===e?(this.categoriesOpen(!1),document.getElementById("gblsearchsolrcatmenu").focus()):(this.categoriesOpen(!this.categoriesOpen()),this.categoriesOpen()&&this.suggestionsOpen()&&this.suggestionsOpen(!1)),!1},i.toggleSuggestions=function(){this.showSuggestions(!this.showSuggestions()),this.toggleCategoryMenu(!0)},i.categorySelected=function(e){null===e?(this.defaultSearch(!0),this.category(null)):(this.category(e),this.categoryName(this.category().text),this.defaultSearch(!1)),this.toggleCategoryMenu(!0)},i.onIndexClicked=function(e,t,o){this.activeIndex(o);for(var s=0;s<this.results().length;s++)this.results()[s].active(s===o)},i.outsideClick=function(){this.suggestionsOpen(!1),this.categoriesOpen(!1),this.showNoResultFlyout(!1)},i.collapsesearch=function(){var e=document.getElementById("gsr-category");e&&(e.style.visibility="hidden"===e.style.visibility?"visible":"hidden","visible"===e.style.visibility&&document.getElementById("gblsearchsolrcatmenulist").focus());var t=document.getElementById("searchSection");t&&(t.style.visibility="hidden"===t.style.visibility?"visible":"hidden")},i.search=function(){var t=this;if(""!==this.inputText()){var n=null===this.category()?void 0:this.category().id,r=new Array,a={searchCriteria:i.inputText()};n&&(a.indexCode=n),e.gsrUrlXhr.done(function(e){var n=e;$.ajax({method:"GET",url:n+"api/GlobalSearch/GetSearchResult",data:a,cache:!1,xhrFields:{withCredentials:!0}}).done(function(e){if(t.categoriesOpen(!1),e&&e.indexes.length>0){for(var n=0;n<e.indexes.length;n++){for(var a=e.indexes[n],l=new o(a.id,a.displayText),u=new Array,c=0;c<a.documents.length;c++){var h=a.documents[c],p=i.getIcon(l.id),d=new s(h.title,h.url,p,h.hasPermission);d.openInPopup=!0,u.push(d)}l.items=u,r.push(l)}t.results(r),t.suggestionsOpen(!0),t.showNoResultFlyout(!1)}else t.suggestionsOpen(!1),t.showNoResultFlyout(!0)})})}else this.suggestionsOpen(!1),this.showNoResultFlyout(!1)},i.selectDefault=function(){return this.categorySelected(null),!1},i.selectCategory=function(e,t,o){return this.categorySelected(e),!1},i.onKeyDown=function(e,t,o){var s=t.which||t.keyCode;return!t.shiftKey&&9===s&&"toggleSuggestions"===o||t.shiftKey,!0},i.resultsKeyDown=function(e,t,o,s){var i=t.which||t.keyCode;return(!t.shiftKey&&9===i&&"link"===s&&o===this.results()[this.activeIndex()].items.length-1||t.shiftKey&&9===i&&"category"===s&&0===o)&&this.suggestionsOpen(!1),!0},i.getIconClass=function(e){return e.iconClass},i.getIcon=function(e){var t="icon-grant";return 9===e&&(t="icon-help"),t},i.getIconFontAwesome=function(e){var t="fa-file-o";return 9===e&&(t="fa-question-circle-o"),t},i.groups=ko.observable([]),e.gsrUrlXhr.done(function(e){var t=e;$.ajax({method:"GET",url:t+"api/GlobalSearch/GetIndexes",data:{},cache:!1,xhrFields:{withCredentials:!0}}).done(function(e){var t=new Array;if(e)for(var s=0;s<e.length;s++){var n=e[s],r=new o(n.id,n.displayText);r.iconClass=i.getIconFontAwesome(r.id),t.push(r)}i.groups(t)})}),e.globalsearch=ko.observable(i);var n=localStorage.isTopBannerCollapsed;e.collapsed=void 0!==n?ko.observable("true"===n):ko.observable(!1),t.mainNav.mouseEnter=function(t,o){"homeTab"!==t.markupId&&e.toggleFlyout(t,!0)},t.mainNav.mouseLeave=function(t,o){"homeTab"!==t.markupId&&e.toggleFlyout(t,!1)},t.mainNav.onKeypress=function(t,o){var s=o.which||o.keyCode;return o.shiftKey||32!==s?!o.shiftKey||9!==s||!t.showFlyout()||(e.toggleFlyout(t,!t.showFlyout()),!0):(e.toggleFlyout(t,!t.showFlyout()),o.preventDefault(),!1)},e.mainNav=ko.observable(t.mainNav),e.utilityMenu=ko.observable(t.utilityMenu),e.flyoutColumnBreak=function(e){return e>=4},e.toggle=function(){e.collapsed(!e.collapsed()),localStorage.isTopBannerCollapsed=e.collapsed()},e.toggleFlyout=function(t,o){o&&0===t.subNavGroups().length&&t.getFlyout(),t.showFlyout(o),e.isFlyoutOpen(o),e.selectedTab(o?t.markupId:""),o?e.openTab(t):e.openTab(null)},e.showTooltip=function(){e.isTooltipOpen(!0)},e.hideTooltip=function(){e.isTooltipOpen(!1)}}var t=this;this.mainNav={visible:!0,menuItems:[],activeTab:t.activeTab,homePageUrl:t.homePageUrl},this.utilityMenu={visible:!0,menuItems:[],logoutUrl:t.logoutUrl,fullName:t.fullName,shortName:t.shortName,userName:t.userName};var i={userTypeCode:t.userTypeCode,deviceCategory:1,useJsonFile:!1},n=$.Deferred();$.ajax({method:"GET",url:t.layoutServiceBaseUrl+"api/layout2/mainnav",data:i,cache:!1,xhrFields:{withCredentials:!0},beforeSend:function(e){}}).done(function(e){t.mainNav.menuItems=e;for(var o=0;o<t.mainNav.menuItems.length;o++)!function(){var e=t.mainNav.menuItems[o];e.showFlyout=ko.observable(!1),e.active=!1,e.markupId.toLowerCase()===t.activeTab.toLowerCase()&&(e.active=!0),e.setActiveTabKO=function(){var t=document.getElementById("toptab"+e.groupId).getElementsByTagName("div")[0];return t&&(t.getElementsByClassName("open").length>0||t.classList.add("open")),localStorage.setItem("activeTab",e.markupId),!0},e.getFlyout=function(){var o={userTypeCode:i.userTypeCode,groupId:e.groupId};$.ajax({method:"GET",url:t.layoutServiceBaseUrl+"api/layout2/flyout",data:o,cache:!1,xhrFields:{withCredentials:!0},beforeSend:function(e){}}).done(function(o){var s=e.subNavGroups();if(!(s.length>e.featuredVideos.length)){if(s.push.apply(s,o),e.getImageUrl=function(){return t.layoutServiceBaseUrl+"dist/images/information-popup.png"},e.getVideoStyle=function(e){return{"background-image":"url("+e+")","background-size":"100%","background-position":"center",width:"180px",height:"90px",color:"white","text-shadow":"1px 1px 3px black"}},e.featuredVideos.length>0){var i={text:"Featured Video",items:[{text:"Featured Video",destination:e.featuredVideos[0].url,hasPopOverContent:!1,helpFlag:!1,videoItems:[{url:e.featuredVideos[0].url,displayText:e.featuredVideos[0].displayText,thumbnailUrl:e.featuredVideos[0].thumbnailUrl,duration:e.featuredVideos[0].duration}]}]};s.push(i)}for(var n=0;n<s.length;n++)!function(){for(var e=s[n],t=0;t<e.items.length;t++){var i=e.items[t];i.showPopover=ko.observable(!1),i.top=ko.observable("0"),i.left=ko.observable("0"),i.mouseEnter=function(e,t){e.showPopover(!0);var o=$(t.target),s=document.getElementsByClassName("system-alert-urgent-message"),i=s&&s.length>0?s[0].clientHeight:0;e.top(o.offset().top-95-i+"px"),e.left(o.position().left+15+"px")},i.keyDown=function(t,s,i,n,r,a,l,u){var c=s.which||s.keyCode;if("popover"===n&&(13===c||32===c)){t.showPopover(!t.showPopover());var h=$(s.target),p=document.getElementsByClassName("system-alert-urgent-message"),d=p&&p.length>0?p[0].clientHeight:0;return t.top(h.offset().top-95-d+"px"),t.left(h.position().left+15+"px"),!1}if(27===c)i&&"popover"!==n?(i.showPopover(!1),$("#info-"+i.text.replace(new RegExp(" ","g"),"")+i.displayOrder).focus()):t.showPopover(!1);else if(!s.shiftKey&&9===c&&"viewall"===n||s.shiftKey&&9===c&&"faqlink"===n&&0===r||!s.shiftKey&&9===c&&"faqlink"===n&&"#"===i.popOverContent.viewAllUrl&&(!i.popOverContent.videoLinks||0===i.popOverContent.videoLinks.length)&&r===i.popOverContent.faqItems.length-1||!s.shiftKey&&9===c&&"videolink"===n&&"#"===i.popOverContent.viewAllUrl&&i.popOverContent.videoLinks&&i.popOverContent.videoLinks.length>0&&r===i.popOverContent.videoLinks.length-1){if(i.showPopover(!1),$("#info-"+i.text.replace(new RegExp(" ","g"),"")+i.displayOrder).focus(),l){var g=l.subNavGroups(),v=i.groupId===g[g.length-1].groupId,f=i.text===a.items[a.items.length-1].text;v&&f&&u.toggleFlyout(l,!1)}}else{if(!s.shiftKey&&32===c&&"popover"===n)return s.preventDefault(),!1;if(!s.shiftKey&&9===c&&"popover"===n&&o[o.length-1].groupId===t.groupId){var y=i.openTab(),m=e.items[e.items.length-1];if(m.displayOrder===t.displayOrder&&r===y.subNavGroups().length-1&&!t.showPopover())return i.toggleFlyout(y,!1),$("#taba"+y.id).focus(),s.preventDefault(),!1}}return!0},i.mouseLeave=function(e,t){e.showPopover(!1)},i.onKeypress=function(e,t,s,i,n,r){if(9===(t.which||t.keyCode)){if(!t.shiftKey&&n&&"video"===n)return i.toggleFlyout(s,!s.showFlyout()),$("#taba"+s.id).focus(),t.preventDefault(),!1;var a=null;if(r)for(var l=0;l<o.length;l++)if(o[l].displayOrder===r.displayOrder){a=o[l];break}if(null!==a){var u=a.items[0],c=s.subNavGroups()[s.subNavGroups().length-1],h=c.items[c.items.length-1];if(t.shiftKey&&u.groupId===e.groupId&&u.text===e.text||!t.shiftKey&&h.groupId===e.groupId&&h.text===e.text&&!h.hasPopOverContent)return i.toggleFlyout(s,!s.showFlyout()),$("#taba"+s.id).focus(),t.preventDefault(),!1}}return!0}}}();e.subNavGroups(s)}})},e.subNavGroups=ko.observable(e.subNavGroups)}();n.resolve()});var r=$.Deferred();$.ajax({method:"GET",url:t.layoutServiceBaseUrl+"api/layout2/utility",data:i,cache:!1,xhrFields:{withCredentials:!0},beforeSend:function(e){}}).done(function(e){t.utilityMenu.menuItems=e;for(var o=0;o<t.utilityMenu.menuItems.length;o++){var s=t.utilityMenu.menuItems[o];s.active=ko.observable(!1),"menu1"==s.markupId&&(s.text="Manage"),s.mouseEnter=function(e,t){e.active(!0)},s.mouseLeave=function(e,t){e.active(!1)},s.keyDown=function(t,o,s,i){var n=i.which||i.keyCode;null!==o&&(s=e[t]);var r=s.active();return!!(i.shiftKey||32!==n&&13!==n||null!==o)&&(i.shiftKey||9!==n||null===o||o!==s.childItems.length-1?i.shiftKey&&9===n&&null===o&&r&&s.active(!r):s.active(!r),!0)},s.keyUp=function(e,t,o){var s=o.which||o.keyCode,i=t.active();if(!(o.shiftKey||32!==s&&13!==s))return t.active(!i),!1;o.shiftKey||9!==s||t.active(!i)}}r.resolve()}),$.when(n,r).then(function(){ko.applyBindings(new e,document.getElementById("topnav-panel"))})},e}();e.LegacyLayoutModern=t;var o=function(){function e(e,t){this.active=ko.observable(!1),this.iconClass="fa-file-o",this.openInPopup=!1,this.id=e,this.text=t}return e}();e.SearchResultGroupModel=o;var s=function(){function e(e,t,o,s){this.openInPopup=!1,this.text=e,this.url=t,this.iconClass=o,this.hasPermission=s}return e}();e.SearchResultItemModel=s}(Platform||(Platform={}));